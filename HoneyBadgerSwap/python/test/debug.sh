#!/usr/bin/env bash
set -e

pkill -f malicious-shamir-party.x || true

#mpc_prog=hbswap_calc_price
#python_prog=Scripts/hbswap/python/server/calc_price_set_data.py

mpc_prog=hbswap_test
python_prog=Scripts/hbswap/python/test/set_data.py

./compile.py -v -C -F 256 $mpc_prog

python3 $python_prog 0 0x0000000000000000000000000000000000000000 0x6b5c9637e0207c72Ee1a275b6C3b686ba8D87385
python3 $python_prog 1 0x0000000000000000000000000000000000000000 0x6b5c9637e0207c72Ee1a275b6C3b686ba8D87385
python3 $python_prog 2 0x0000000000000000000000000000000000000000 0x6b5c9637e0207c72Ee1a275b6C3b686ba8D87385
python3 $python_prog 3 0x0000000000000000000000000000000000000000 0x6b5c9637e0207c72Ee1a275b6C3b686ba8D87385

./malicious-shamir-party.x -N 4 -T 1 -p 0 -pn 5000 -P 52435875175126190479447740508185965837690552500527637822603658699938581184513 $mpc_prog &
./malicious-shamir-party.x -N 4 -T 1 -p 1 -pn 5000 -P 52435875175126190479447740508185965837690552500527637822603658699938581184513 $mpc_prog &
./malicious-shamir-party.x -N 4 -T 1 -p 2 -pn 5000 -P 52435875175126190479447740508185965837690552500527637822603658699938581184513 $mpc_prog &
./malicious-shamir-party.x -N 4 -T 1 -p 3 -pn 5000 -P 52435875175126190479447740508185965837690552500527637822603658699938581184513 $mpc_prog